import pandas as pd

# Step 1: Load Dataset
df = pd.read_csv("amazon_reviews.csv")
print("Original Data:\n", df)

# Step 2: Subset (Select only specific columns)
subset_df = df[["UserID", "BookTitle", "Rating"]]
print("\nSubset Columns:\n", subset_df)

# Step 3: Merge with another DataFrame (Simulated user data)
user_data = pd.DataFrame({
    'UserID': ['U101', 'U102', 'U103'],
    'Location': ['Mumbai', 'Delhi', 'Bangalore']
})
merged = pd.merge(subset_df, user_data, on='UserID')
print("\nMerged Data:\n", merged)

# Step 4: Sort the DataFrame by Rating
sorted_df = merged.sort_values(by="Rating", ascending=False)
print("\nSorted by Rating:\n", sorted_df)

# Step 5: Transpose the DataFrame
transposed = subset_df.T
print("\nTransposed Data:\n", transposed)

# Step 6: Reshape using pivot (if needed)
pivot_df = df.pivot_table(index="BookTitle", values="Rating", aggfunc='mean')
print("\nPivot (Mean Rating per Book):\n", pivot_df)
