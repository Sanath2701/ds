import pandas as pd

# Sample Amazon Book Reviews dataset
data = {
    'ReviewerID': ['R1', 'R2', 'R3', 'R4'],
    'BookTitle': ['Book A', 'Book B', 'Book C', 'Book D'],
    'Rating': [5, 3, 4, 2],
    'Review': ['Excellent!', 'Okay read', 'Good book', 'Not great']
}

df = pd.DataFrame(data)

print("ğŸ“˜ Original DataFrame:")
print(df)

# 1ï¸âƒ£ Subset: Selecting specific rows
subset = df[df['Rating'] >= 4]
print("\nğŸ“— Subset (Rating >= 4):")
print(subset)

# 2ï¸âƒ£ Merge: Merge with another DataFrame
book_info = pd.DataFrame({
    'BookTitle': ['Book A', 'Book B', 'Book C', 'Book D'],
    'Author': ['Author A', 'Author B', 'Author C', 'Author D']
})

merged = pd.merge(df, book_info, on='BookTitle')
print("\nğŸ“˜ Merged DataFrame:")
print(merged)

# 3ï¸âƒ£ Sort: Sort rows by Rating
sorted_df = df.sort_values(by='Rating', ascending=False)
print("\nğŸ“˜ Sorted by Rating (descending):")
print(sorted_df)

# 4ï¸âƒ£ Transpose: Rows <-> Columns
transposed = df.T
print("\nğŸ“˜ Transposed DataFrame:")
print(transposed)

# 5ï¸âƒ£ Reshape: Using melt (row-wise reshape)
reshaped = pd.melt(df, id_vars=['ReviewerID'], value_vars=['BookTitle', 'Rating'])
print("\nğŸ“˜ Reshaped (melted) DataFrame:")
print(reshaped)
